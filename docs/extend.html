---

title: extend


keywords: fastai
sidebar: home_sidebar

summary: "Extend an already existing `pd.DataFrame` with new data"
description: "Extend an already existing `pd.DataFrame` with new data"
nb_path: "70_extend.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 70_extend.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_directory</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s1">&#39;samples&#39;</span>
<span class="k">assert</span> <span class="n">df_directory</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_directory</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/manu/dlsproc/samples
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Input directory for the <code>pd.DataFrame</code> to be updated</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_input_file</span> <span class="o">=</span> <span class="n">df_directory</span> <span class="o">/</span> <span class="s1">&#39;2018-2021_20samples.parquet&#39;</span>
<span class="k">assert</span> <span class="n">df_input_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_input_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/manu/dlsproc/samples/2018-2021_20samples.parquet
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The specific file is</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">historical_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">df_input_file</span><span class="p">)</span>
<span class="n">historical_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th colspan="16" halign="left">ContractFolderStatus</th>
      <th>deleted_on</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>ContractFolderID</th>
      <th>ContractFolderStatusCode</th>
      <th colspan="2" halign="left">LocatedContractingParty</th>
      <th colspan="2" halign="left">ProcurementProject</th>
      <th>...</th>
      <th colspan="2" halign="left">LegalDocumentReference</th>
      <th colspan="2" halign="left">TechnicalDocumentReference</th>
      <th colspan="2" halign="left">LocatedContractingParty</th>
      <th colspan="3" halign="left">TenderingProcess</th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Party</th>
      <th>Name</th>
      <th>TypeCode</th>
      <th>...</th>
      <th>ID</th>
      <th>Attachment</th>
      <th>ID</th>
      <th>Attachment</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th colspan="2" halign="left">ParticipationRequestReceptionPeriod</th>
      <th>TenderSubmissionDeadlinePeriod</th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>PartyIdentification</th>
      <th>PartyName</th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th>ExternalReference</th>
      <th></th>
      <th>ExternalReference</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th>EndDate</th>
      <th>EndTime</th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th>URI</th>
      <th></th>
      <th>URI</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>PartyName</th>
      <th>ParentLocatedParty</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Name</th>
      <th>PartyName</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>file name</th>
      <th>entry</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">PlataformasAgregadasSinMenores_20180217_180137_1.atom</th>
      <th>453</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Expediente: 1284/17, Entidad: Diputación Provi...</td>
      <td>Refuerzo de Firme en la VP 3001 Renedo de Esgu...</td>
      <td>2018-01-02 08:01:52.024000+00:00</td>
      <td>1284/17</td>
      <td>RES</td>
      <td>L02000047</td>
      <td>Diputación Provincial de Valladolid</td>
      <td>Refuerzo de Firme en la VP 3001 Renedo de Esgu...</td>
      <td>3.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-11-02</td>
      <td>23:59:00</td>
      <td>2017-11-02 23:59:00+00:00</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>452</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Expediente: 1282/17, Entidad: Diputación Provi...</td>
      <td>Refuerzo de Firme en la VP 6603 Mota del Marqu...</td>
      <td>2018-01-02 08:02:24.833000+00:00</td>
      <td>1282/17</td>
      <td>RES</td>
      <td>L02000047</td>
      <td>Diputación Provincial de Valladolid</td>
      <td>Refuerzo de Firme en la VP 6603 Mota del Marqu...</td>
      <td>3.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-11-02</td>
      <td>23:59:00</td>
      <td>2017-11-02 23:59:00+00:00</td>
      <td>NaT</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 41 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The directory for the zip file whose data is to appended to the already existing <code>pd.DataFrame</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zip_directory</span> <span class="o">=</span> <span class="n">df_directory</span>
<span class="k">assert</span> <span class="n">zip_directory</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zip_directory</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/manu/dlsproc/samples
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The particular file</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zip_file</span> <span class="o">=</span> <span class="n">zip_directory</span> <span class="o">/</span> <span class="s1">&#39;PlataformasAgregadasSinMenores_202201_05-06.zip&#39;</span>
<span class="k">assert</span> <span class="n">zip_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">zip_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/manu/dlsproc/samples/PlataformasAgregadasSinMenores_202201_05-06.zip
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">bundle</span><span class="o">.</span><span class="n">read_zip</span><span class="p">(</span><span class="n">zip_file</span><span class="p">,</span> <span class="n">concatenate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">hier</span><span class="o">.</span><span class="n">flat_df_to_multiindexed_df</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Number of levels in the columns</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">last_update_only_df</span> <span class="o">=</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">postprocess</span><span class="o">.</span><span class="n">keep_updates_only</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deleted_series</span> <span class="o">=</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">bundle</span><span class="o">.</span><span class="n">read_deleted_zip</span><span class="p">(</span><span class="n">zip_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Duplicates are removed from the above <code>pd.Series</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deduplicated_deleted_series</span> <span class="o">=</span> <span class="n">deleted_series</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">deleted_series</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">deduplicated_deleted_series</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>file name                                            id                                                                                 
PlataformasAgregadasSinMenores_20220105_030012.atom  https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1959074   2022-01-04 00:11:56.497000+01:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1957921   2022-01-04 00:11:56.535000+01:00
Name: deleted_on, dtype: datetime64[ns, pytz.FixedOffset(60)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to make it easy to update the <code>deleted_on</code> column in the existing <code>pd.DataFrame</code> using the data contained in the <em>deleted</em> <code>pd.Series</code> (i.e., to get <em>automatic 
alignment</em>), we reindex the dataframe in the same way as the series.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">reindexed_new_df</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;file name&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">])</span>
<span class="n">reindexed_new_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>entry</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th colspan="17" halign="left">ContractFolderStatus</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>ContractFolderID</th>
      <th>ContractFolderStatusCode</th>
      <th colspan="3" halign="left">LocatedContractingParty</th>
      <th colspan="3" halign="left">ProcurementProject</th>
      <th colspan="2" halign="left">LegalDocumentReference</th>
      <th>ProcurementProject</th>
      <th colspan="2" halign="left">TechnicalDocumentReference</th>
      <th>LocatedContractingParty</th>
      <th colspan="3" halign="left">TenderingProcess</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>BuyerProfileURIID</th>
      <th>Party</th>
      <th>ParentLocatedParty</th>
      <th>Name</th>
      <th>...</th>
      <th>PlannedPeriod</th>
      <th>ID</th>
      <th>Attachment</th>
      <th>PlannedPeriod</th>
      <th>ID</th>
      <th>Attachment</th>
      <th>ParentLocatedParty</th>
      <th colspan="2" halign="left">ParticipationRequestReceptionPeriod</th>
      <th>TenderSubmissionDeadlinePeriod</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>PartyName</th>
      <th>PartyName</th>
      <th></th>
      <th>...</th>
      <th>StartDate</th>
      <th></th>
      <th>ExternalReference</th>
      <th>EndDate</th>
      <th></th>
      <th>ExternalReference</th>
      <th>ParentLocatedParty</th>
      <th>EndDate</th>
      <th>EndTime</th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Name</th>
      <th>Name</th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th>URI</th>
      <th></th>
      <th></th>
      <th>URI</th>
      <th>PartyName</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>file name</th>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">PlataformasAgregadasSinMenores_20220105_030012.atom</th>
      <th>https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/8769544</th>
      <td>0</td>
      <td>Id licitación: 2021039438; Órgano de Contratac...</td>
      <td>L'objecte és la contractació del servei de bug...</td>
      <td>2022-01-04 12:12:09.464000+00:00</td>
      <td>2021039438</td>
      <td>RES</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Girona</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte és la contractació del servei de bug...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-12-13 23:59:00+00:00</td>
    </tr>
    <tr>
      <th>https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/8692029</th>
      <td>1</td>
      <td>Id licitación: 2021_2568; Órgano de Contrataci...</td>
      <td>Servei comunicacions postals de l'Ajuntament d...</td>
      <td>2022-01-04 12:12:09.400000+00:00</td>
      <td>2021_2568</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Collbató</td>
      <td>Entitats municipals de Catalunya</td>
      <td>Servei comunicacions postals de l'Ajuntament d...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-11-29 23:59:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 39 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What is the intersection between the entries in the new <code>pd.DataFrame</code> and the series with information about deletes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">new_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">deduplicated_deleted_series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>set()</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Old and new data are stacked together</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">concatenated_df</span> <span class="o">=</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">assemble</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">historical_df</span><span class="p">,</span> <span class="n">new_df</span><span class="p">)</span>
<span class="n">concatenated_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th colspan="15" halign="left">ContractFolderStatus</th>
      <th>deleted_on</th>
      <th>ContractFolderStatus</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>ContractFolderID</th>
      <th>ContractFolderStatusCode</th>
      <th colspan="2" halign="left">LocatedContractingParty</th>
      <th colspan="2" halign="left">ProcurementProject</th>
      <th>...</th>
      <th>LegalDocumentReference</th>
      <th colspan="2" halign="left">TechnicalDocumentReference</th>
      <th colspan="2" halign="left">LocatedContractingParty</th>
      <th colspan="3" halign="left">TenderingProcess</th>
      <th></th>
      <th>LocatedContractingParty</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Party</th>
      <th>Name</th>
      <th>TypeCode</th>
      <th>...</th>
      <th>Attachment</th>
      <th>ID</th>
      <th>Attachment</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th colspan="2" halign="left">ParticipationRequestReceptionPeriod</th>
      <th>TenderSubmissionDeadlinePeriod</th>
      <th></th>
      <th>BuyerProfileURIID</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>PartyIdentification</th>
      <th>PartyName</th>
      <th></th>
      <th></th>
      <th>...</th>
      <th>ExternalReference</th>
      <th></th>
      <th>ExternalReference</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th>EndDate</th>
      <th>EndTime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th></th>
      <th></th>
      <th>...</th>
      <th>URI</th>
      <th></th>
      <th>URI</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th>PartyName</th>
      <th>ParentLocatedParty</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th>Name</th>
      <th>PartyName</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>file name</th>
      <th>entry</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">PlataformasAgregadasSinMenores_20180217_180137_1.atom</th>
      <th>453</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Expediente: 1284/17, Entidad: Diputación Provi...</td>
      <td>Refuerzo de Firme en la VP 3001 Renedo de Esgu...</td>
      <td>2018-01-02 08:01:52.024000+00:00</td>
      <td>1284/17</td>
      <td>RES</td>
      <td>L02000047</td>
      <td>Diputación Provincial de Valladolid</td>
      <td>Refuerzo de Firme en la VP 3001 Renedo de Esgu...</td>
      <td>3.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-11-02</td>
      <td>23:59:00</td>
      <td>2017-11-02 23:59:00+00:00</td>
      <td>NaT</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>452</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Expediente: 1282/17, Entidad: Diputación Provi...</td>
      <td>Refuerzo de Firme en la VP 6603 Mota del Marqu...</td>
      <td>2018-01-02 08:02:24.833000+00:00</td>
      <td>1282/17</td>
      <td>RES</td>
      <td>L02000047</td>
      <td>Diputación Provincial de Valladolid</td>
      <td>Refuerzo de Firme en la VP 6603 Mota del Marqu...</td>
      <td>3.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-11-02</td>
      <td>23:59:00</td>
      <td>2017-11-02 23:59:00+00:00</td>
      <td>NaT</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>451</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Expediente: 1281/17, Entidad: Diputación Provi...</td>
      <td>Refuerzo de firme en la VP 4013 Melgar de Arri...</td>
      <td>2018-01-02 08:02:51.744000+00:00</td>
      <td>1281/17</td>
      <td>RES</td>
      <td>L02000047</td>
      <td>Diputación Provincial de Valladolid</td>
      <td>Refuerzo de firme en la VP 4013 Melgar de Arri...</td>
      <td>3.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-11-02</td>
      <td>23:59:00</td>
      <td>2017-11-02 23:59:00+00:00</td>
      <td>NaT</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>450</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: VI/17/04-015; Órgano de Contrat...</td>
      <td>Obras de edificación en el barrio de Pumarabul...</td>
      <td>2018-01-02 08:02:56.115000+00:00</td>
      <td>VI/17/04-015</td>
      <td>EV</td>
      <td>&lt;NA&gt;</td>
      <td>Consejería de Servicios y Derechos Sociales</td>
      <td>Edificación de 36 VPP, garaje y trasteros en e...</td>
      <td>3.0</td>
      <td>...</td>
      <td>http://www.asturias.es/Proveedores/FICHEROS/ES...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-12-11 14:00:00+00:00</td>
      <td>NaT</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>449</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id Licitación: PcPG/2017/194222, Órgano de Con...</td>
      <td>Suministro de gas natural canalizado y gas nat...</td>
      <td>2018-01-02 09:10:49.572000+00:00</td>
      <td>PcPG/2017/194222</td>
      <td>ADJ</td>
      <td>A12017369</td>
      <td>Consellería de Economía, Emprego e Industria</td>
      <td>Suministro de gas natural canalizado y gas nat...</td>
      <td>1.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-09-29 23:59:00+00:00</td>
      <td>NaT</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">PlataformasAgregadasSinMenores_20220106_030013.atom</th>
      <th>471</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021/57-12334; Órgano de Contra...</td>
      <td>L'objecte d'aquest contracte és la prestació c...</td>
      <td>2022-01-04 12:12:09.949000+00:00</td>
      <td>2021/57-12334</td>
      <td>PUB</td>
      <td>&lt;NA&gt;</td>
      <td>Ajuntament de Palau-solità i Plegamans</td>
      <td>L'objecte d'aquest contracte és la prestació c...</td>
      <td>1.0</td>
      <td>...</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>PPT_subministrament 8 cameres videovigilancia_...</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2022-01-19 15:00:00+00:00</td>
      <td>NaT</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
    </tr>
    <tr>
      <th>472</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 32/2021; Órgano de Contratación...</td>
      <td>Licitació per procediment obert harmonitzat i ...</td>
      <td>2022-01-04 12:12:09.742000+00:00</td>
      <td>32/2021</td>
      <td>RES</td>
      <td>&lt;NA&gt;</td>
      <td>Consell Comarcal del Baix Llobregat</td>
      <td>Licitació per procediment obert harmonitzat i ...</td>
      <td>2.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-05-07 15:00:00+00:00</td>
      <td>NaT</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
    </tr>
    <tr>
      <th>473</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 1977/2021; Órgano de Contrataci...</td>
      <td>L'objecte d'aquest contracte és la prestació d...</td>
      <td>2022-01-04 12:12:09.666000+00:00</td>
      <td>1977/2021</td>
      <td>RES</td>
      <td>&lt;NA&gt;</td>
      <td>Ajuntament de Sant Adrià de Besòs</td>
      <td>L'objecte d'aquest contracte és la prestació d...</td>
      <td>2.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-06-30 23:59:00+00:00</td>
      <td>NaT</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
    </tr>
    <tr>
      <th>474</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: EXI-2022-7; Órgano de Contratac...</td>
      <td>Servei de trasllat de béns mobles( mobiliari, ...</td>
      <td>2022-01-04 12:12:09.602000+00:00</td>
      <td>EXI-2022-7</td>
      <td>ADJ</td>
      <td>&lt;NA&gt;</td>
      <td>Departament d'Acció Exterior i Govern Obert</td>
      <td>Servei de trasllat de béns mobles( mobiliari, ...</td>
      <td>2.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-12-13 13:00:00+00:00</td>
      <td>NaT</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
    </tr>
    <tr>
      <th>475</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: CONTR/2021/000000137; Órgano de...</td>
      <td>Servei de redacció del Projecte Executiu d'obr...</td>
      <td>2022-01-04 12:12:09.536000+00:00</td>
      <td>CONTR/2021/000000137</td>
      <td>ADJ</td>
      <td>&lt;NA&gt;</td>
      <td>Institut d'Assistència Sanitària (IAS)</td>
      <td>Servei de redacció del Projecte Executiu d'obr...</td>
      <td>2.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-11-10 18:00:00+00:00</td>
      <td>NaT</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
    </tr>
  </tbody>
</table>
<p>971 rows × 42 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to make it easy to update the <code>deleted_on</code> column in the existing <code>pd.DataFrame</code> using the data contained in the <em>deleted</em> <code>pd.Series</code> (i.e., to get <em>automatic 
alignment</em>), we reindex the dataframe in the same way as the series.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">concatenated_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;file name&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">])</span>
<span class="n">res</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>entry</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th colspan="15" halign="left">ContractFolderStatus</th>
      <th>deleted_on</th>
      <th>ContractFolderStatus</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>ContractFolderID</th>
      <th>ContractFolderStatusCode</th>
      <th colspan="2" halign="left">LocatedContractingParty</th>
      <th colspan="2" halign="left">ProcurementProject</th>
      <th>...</th>
      <th>LegalDocumentReference</th>
      <th colspan="2" halign="left">TechnicalDocumentReference</th>
      <th colspan="2" halign="left">LocatedContractingParty</th>
      <th colspan="3" halign="left">TenderingProcess</th>
      <th></th>
      <th>LocatedContractingParty</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Party</th>
      <th>Name</th>
      <th>TypeCode</th>
      <th>...</th>
      <th>Attachment</th>
      <th>ID</th>
      <th>Attachment</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th colspan="2" halign="left">ParticipationRequestReceptionPeriod</th>
      <th>TenderSubmissionDeadlinePeriod</th>
      <th></th>
      <th>BuyerProfileURIID</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>PartyIdentification</th>
      <th>PartyName</th>
      <th></th>
      <th></th>
      <th>...</th>
      <th>ExternalReference</th>
      <th></th>
      <th>ExternalReference</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th>EndDate</th>
      <th>EndTime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>ID</th>
      <th>Name</th>
      <th></th>
      <th></th>
      <th>...</th>
      <th>URI</th>
      <th></th>
      <th>URI</th>
      <th colspan="2" halign="left">ParentLocatedParty</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th>PartyName</th>
      <th>ParentLocatedParty</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th>Name</th>
      <th>PartyName</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>...</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>file name</th>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">PlataformasAgregadasSinMenores_20180217_180137_1.atom</th>
      <th>https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1992428</th>
      <td>453</td>
      <td>Expediente: 1284/17, Entidad: Diputación Provi...</td>
      <td>Refuerzo de Firme en la VP 3001 Renedo de Esgu...</td>
      <td>2018-01-02 08:01:52.024000+00:00</td>
      <td>1284/17</td>
      <td>RES</td>
      <td>L02000047</td>
      <td>Diputación Provincial de Valladolid</td>
      <td>Refuerzo de Firme en la VP 3001 Renedo de Esgu...</td>
      <td>3.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-11-02</td>
      <td>23:59:00</td>
      <td>2017-11-02 23:59:00+00:00</td>
      <td>NaT</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1992427</th>
      <td>452</td>
      <td>Expediente: 1282/17, Entidad: Diputación Provi...</td>
      <td>Refuerzo de Firme en la VP 6603 Mota del Marqu...</td>
      <td>2018-01-02 08:02:24.833000+00:00</td>
      <td>1282/17</td>
      <td>RES</td>
      <td>L02000047</td>
      <td>Diputación Provincial de Valladolid</td>
      <td>Refuerzo de Firme en la VP 6603 Mota del Marqu...</td>
      <td>3.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2017-11-02</td>
      <td>23:59:00</td>
      <td>2017-11-02 23:59:00+00:00</td>
      <td>NaT</td>
      <td>&lt;NA&gt;</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 42 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deduplicated_deleted_series</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;PlataformasAgregadasSinMenores_20220105_030012.atom&#39;,
 &#39;https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1959074&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#  &#39;https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1959074&#39;)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to see if something changes when updating column <code>deleted_on</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bak_res</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Update</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;deleted_on&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deduplicated_deleted_series</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bak_res</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

