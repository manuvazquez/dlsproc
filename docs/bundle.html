---

title: bundle


keywords: fastai
sidebar: home_sidebar

summary: "Functionality to deal with multiple XML files"
description: "Functionality to deal with multiple XML files"
nb_path: "20_bundle.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 20_bundle.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some handy imports that are not actually required by the library.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Directory where the zip files are stored</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">directory</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s1">'samples'</span>
<span class="k">assert</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="n">directory</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;/home/manu/dlsproc/samples&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Zip-file">Zip file<a class="anchor-link" href="#Zip-file"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A (sample) file in that directory</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">input_file</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="s1">'PlataformasAgregadasSinMenores_202201_05-06.zip'</span>
<span class="k">assert</span> <span class="n">input_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="n">input_file</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;/home/manu/dlsproc/samples/PlataformasAgregadasSinMenores_202201_05-06.zip&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A function to read <strong>all</strong> the <em>XML</em> files contained in a given zip file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_zip" class="doc_header"><code>read_zip</code><a href="https://github.com/manuvazquez/dlsproc/tree/master/dlsproc/bundle.py#L15" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_zip</code>(<strong><code>input_file</code></strong>:<code>Path</code>[<code>str</code>, <code>Path</code>], <strong><code>concatenate</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>return_filenames</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Reads and parses an XML file into a <code>pd.DataFrame</code>.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p>input_file: str or Path</p>
<p>Input file.</p>
</li>
<li><p>concatenate: bool</p>
<p>Whether or not to concatenate all the files in a single <code>pd.DataFrame</code>.</p>
</li>
<li><p>return_filenames: bool</p>
<p>Whether or not names of the files (read) within the zip are returned.</p>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><p>out: pd.DataFrame</p>
<p>A Pandas DataFrame with XML data.</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfs_zip</span> <span class="o">=</span> <span class="n">read_zip</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dfs_zip</span><span class="p">)</span><span class="si">=}</span><span class="s1">'</span><span class="p">)</span>
<span class="n">dfs_zip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>len(dfs_zip)=2
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>...</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - LegalDocumentReference - ID</th>
      <th>ContractFolderStatus - LegalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - ID</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021039438; Órgano de Contratac...</td>
      <td>L'objecte és la contractació del servei de bug...</td>
      <td>2022-01-04 12:12:09.464000+00:00</td>
      <td>2021039438</td>
      <td>RES</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Girona</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte és la contractació del servei de bug...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-12-13 23:59:00+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021_2568; Órgano de Contrataci...</td>
      <td>Servei comunicacions postals de l'Ajuntament d...</td>
      <td>2022-01-04 12:12:09.400000+00:00</td>
      <td>2021_2568</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Collbató</td>
      <td>Entitats municipals de Catalunya</td>
      <td>Servei comunicacions postals de l'Ajuntament d...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-11-29 23:59:00+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 12450/2021; Órgano de Contratac...</td>
      <td>L'objecte del contracte és l'execució de les o...</td>
      <td>2022-01-04 12:12:09.343000+00:00</td>
      <td>12450/2021</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Mont-roig del Camp</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte del contracte és l'execució de les o...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-12-20 14:00:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 39 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A single <code>pd.DataFrame</code> encompassing all the files in the zip can be returned (file names are used as the top-level index)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfs_concatenated_zip</span> <span class="o">=</span> <span class="n">read_zip</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">concatenate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dfs_concatenated_zip</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>...</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - LegalDocumentReference - ID</th>
      <th>ContractFolderStatus - LegalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - ID</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
    <tr>
      <th>file name</th>
      <th>entry</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">PlataformasAgregadasSinMenores_20220105_030012.atom</th>
      <th>0</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021039438; Órgano de Contratac...</td>
      <td>L'objecte és la contractació del servei de bug...</td>
      <td>2022-01-04 12:12:09.464000+00:00</td>
      <td>2021039438</td>
      <td>RES</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Girona</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte és la contractació del servei de bug...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-12-13 23:59:00+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021_2568; Órgano de Contrataci...</td>
      <td>Servei comunicacions postals de l'Ajuntament d...</td>
      <td>2022-01-04 12:12:09.400000+00:00</td>
      <td>2021_2568</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Collbató</td>
      <td>Entitats municipals de Catalunya</td>
      <td>Servei comunicacions postals de l'Ajuntament d...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-11-29 23:59:00+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 12450/2021; Órgano de Contratac...</td>
      <td>L'objecte del contracte és l'execució de les o...</td>
      <td>2022-01-04 12:12:09.343000+00:00</td>
      <td>12450/2021</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Mont-roig del Camp</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte del contracte és l'execució de les o...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-12-20 14:00:00+00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021/14/M0400100; Órgano de Con...</td>
      <td>El serveiobjecte del contracte és la difusió p...</td>
      <td>2022-01-04 12:12:09.285000+00:00</td>
      <td>2021/14/M0400100</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Casa de Cultura de Girona</td>
      <td>Entitats municipals de Catalunya</td>
      <td>El serveiobjecte del contracte és la difusió p...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-10-22 14:00:00+00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: ICVI-2022-1; Órgano de Contrata...</td>
      <td>Servei de neteja de les instal·lacions de l'IN...</td>
      <td>2022-01-04 12:12:09.227000+00:00</td>
      <td>ICVI-2022-1</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Institut Català de la Vinya i el Vi (INCAVI)</td>
      <td>Departaments i Sector Públic de la Generalitat</td>
      <td>Servei de neteja de les instal·lacions de l'IN...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-11-30 18:00:00+00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">PlataformasAgregadasSinMenores_20220106_030013.atom</th>
      <th>471</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021/57-12334; Órgano de Contra...</td>
      <td>L'objecte d'aquest contracte és la prestació c...</td>
      <td>2022-01-04 12:12:09.949000+00:00</td>
      <td>2021/57-12334</td>
      <td>PUB</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Palau-solità i Plegamans</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte d'aquest contracte és la prestació c...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>PCAP subminist. 8 cameres videovigilancia 2021...</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>&lt;NA&gt;</td>
      <td>PPT_subministrament 8 cameres videovigilancia_...</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2022-01-19 15:00:00+00:00</td>
    </tr>
    <tr>
      <th>472</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 32/2021; Órgano de Contratación...</td>
      <td>Licitació per procediment obert harmonitzat i ...</td>
      <td>2022-01-04 12:12:09.742000+00:00</td>
      <td>32/2021</td>
      <td>RES</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Consell Comarcal del Baix Llobregat</td>
      <td>Entitats municipals de Catalunya</td>
      <td>Licitació per procediment obert harmonitzat i ...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-05-07 15:00:00+00:00</td>
    </tr>
    <tr>
      <th>473</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 1977/2021; Órgano de Contrataci...</td>
      <td>L'objecte d'aquest contracte és la prestació d...</td>
      <td>2022-01-04 12:12:09.666000+00:00</td>
      <td>1977/2021</td>
      <td>RES</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Sant Adrià de Besòs</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte d'aquest contracte és la prestació d...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-06-30 23:59:00+00:00</td>
    </tr>
    <tr>
      <th>474</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: EXI-2022-7; Órgano de Contratac...</td>
      <td>Servei de trasllat de béns mobles( mobiliari, ...</td>
      <td>2022-01-04 12:12:09.602000+00:00</td>
      <td>EXI-2022-7</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Departament d'Acció Exterior i Govern Obert</td>
      <td>Departaments i Sector Públic de la Generalitat</td>
      <td>Servei de trasllat de béns mobles( mobiliari, ...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-12-13 13:00:00+00:00</td>
    </tr>
    <tr>
      <th>475</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: CONTR/2021/000000137; Órgano de...</td>
      <td>Servei de redacció del Projecte Executiu d'obr...</td>
      <td>2022-01-04 12:12:09.536000+00:00</td>
      <td>CONTR/2021/000000137</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Institut d'Assistència Sanitària (IAS)</td>
      <td>Departaments i Sector Públic de la Generalitat</td>
      <td>Servei de redacció del Projecte Executiu d'obr...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2021-11-10 18:00:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>951 rows × 39 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfs_concatenated_zip</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>id                      string
summary                 string
title                   string
updated    datetime64[ns, UTC]
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Filenames can also be requested</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="o">=</span> <span class="n">read_zip</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="n">return_filenames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;PlataformasAgregadasSinMenores_20220105_030012.atom&#39;, &#39;PlataformasAgregadasSinMenores_20220106_030013.atom&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Deleted-entries">Deleted entries<a class="anchor-link" href="#Deleted-entries"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_deleted_zip" class="doc_header"><code>read_deleted_zip</code><a href="https://github.com/manuvazquez/dlsproc/tree/master/dlsproc/bundle.py#L73" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_deleted_zip</code>(<strong><code>input_file</code></strong>:<code>Path</code>[<code>str</code>, <code>Path</code>])</p>
</blockquote>
<p>Reads and parses an XML file into a <code>pd.DataFrame</code>.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p>input_file: str or Path</p>
<p>Input file.</p>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><p>out: pd.Series</p>
<p>A Pandas Series with XML data.</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">read_deleted_zip</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>file name                                            id                                                                                 
PlataformasAgregadasSinMenores_20220105_030012.atom  https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/6724977   2022-01-04 00:12:01.376000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968315   2022-01-03 23:11:57.567000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968345   2022-01-03 23:11:57.516000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968324   2022-01-03 23:11:57.471000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968344   2022-01-03 23:11:57.426000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968337   2022-01-03 23:11:57.375000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968321   2022-01-03 23:11:57.323000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968335   2022-01-03 23:11:57.275000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968343   2022-01-03 23:11:57.232000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968333   2022-01-03 23:11:57.183000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968360   2022-01-03 23:11:57.141000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968327   2022-01-03 23:11:57.089000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968318   2022-01-03 23:11:57.038000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968361   2022-01-03 23:11:56.991000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968332   2022-01-03 23:11:56.949000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968331   2022-01-03 23:11:56.897000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968329   2022-01-03 23:11:56.850000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968338   2022-01-03 23:11:56.805000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968317   2022-01-03 23:11:56.751000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968358   2022-01-03 23:11:56.706000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968346   2022-01-03 23:11:56.661000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968319   2022-01-03 23:11:56.620000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968325   2022-01-03 23:11:56.579000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1957921   2022-01-03 23:11:56.535000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1959074   2022-01-03 23:11:56.497000+00:00
PlataformasAgregadasSinMenores_20220106_030013.atom  https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968294   2022-01-04 23:12:13.328000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968301   2022-01-04 23:12:13.283000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968299   2022-01-04 23:12:13.236000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968291   2022-01-04 23:12:13.191000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968286   2022-01-04 23:12:13.147000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968282   2022-01-04 23:12:13.107000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968303   2022-01-04 23:12:13.058000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968269   2022-01-04 23:12:13.013000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968272   2022-01-04 23:12:12.957000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968284   2022-01-04 23:12:12.911000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968280   2022-01-04 23:12:12.865000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968285   2022-01-04 23:12:12.819000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968267   2022-01-04 23:12:12.775000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968268   2022-01-04 23:12:12.731000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968302   2022-01-04 23:12:12.680000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968290   2022-01-04 23:12:12.635000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968271   2022-01-04 23:12:12.172000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968289   2022-01-04 23:12:12.129000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968305   2022-01-04 23:12:12.076000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968279   2022-01-04 23:12:12.039000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968287   2022-01-04 23:12:11.998000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968288   2022-01-04 23:12:11.957000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1968266   2022-01-04 23:12:11.916000+00:00
                                                     https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/8892704   2022-01-04 13:13:12.670000+00:00
Name: deleted_on, dtype: datetime64[ns, UTC]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Directory">Directory<a class="anchor-link" href="#Directory"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A convenience function to read a bunch of zip files inside a directory</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_zips_directory" class="doc_header"><code>read_zips_directory</code><a href="https://github.com/manuvazquez/dlsproc/tree/master/dlsproc/bundle.py#L112" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_zips_directory</code>(<strong><code>input_directory</code></strong>:<code>Path</code>[<code>str</code>, <code>Path</code>], <strong><code>concatenate</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Reads and parses an XML file into a <code>pd.DataFrame</code>.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p>input_directory: str or Path</p>
<p>Input directory.</p>
</li>
<li><p>concatenate: bool</p>
<p>Whether or not to concatenate all the files in a single <code>pd.DataFrame</code>.</p>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><p>out: pd.DataFrame</p>
<p>A Pandas DataFrame with XML data.</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zips_df</span> <span class="o">=</span> <span class="n">read_zips_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">concatenate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">zips_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(3340, 40)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zips_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>...</th>
      <th>ContractFolderStatus - ValidNoticeInfo - AdditionalPublicationStatus - AdditionalPublicationDocumentReference - IssueDate</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
    <tr>
      <th>zip</th>
      <th>file name</th>
      <th>entry</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">PlataformasAgregadasSinMenores_202201_08-11.zip</th>
      <th rowspan="5" valign="top">PlataformasAgregadasSinMenores_20220108_030015.atom</th>
      <th>0</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2019/51-HH-ZE; Órgano de Contr...</td>
      <td>Servicios de asistencia técnica para la dinami...</td>
      <td>2022-01-07 12:41:24.713000+00:00</td>
      <td>2019/51-HH-ZE</td>
      <td>RES</td>
      <td>Diputado/a Foral de Medio Ambiente y Obras Hid...</td>
      <td>Diputación Foral de Gipuzkoa</td>
      <td>Departamento de Medio Ambiente y Obras Hidrául...</td>
      <td>Servicios de asistencia técnica para la dinami...</td>
      <td>...</td>
      <td>[2019-12-23, 2020-01-02, 2020-05-07, [2021-01-...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2020-01-23 14:30:00+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2019/49-VA-ZE; Órgano de Contr...</td>
      <td>Servicios de asesoramiento en comunicación par...</td>
      <td>2022-01-07 12:41:24.627000+00:00</td>
      <td>2019/49-VA-ZE</td>
      <td>RES</td>
      <td>Diputado/a Foral de Medio Ambiente y Obras Hid...</td>
      <td>Diputación Foral de Gipuzkoa</td>
      <td>Departamento de Medio Ambiente y Obras Hidrául...</td>
      <td>Servicios de asesoramiento en comunicación par...</td>
      <td>...</td>
      <td>[2019-12-23, 2020-01-02, 2020-05-07, [2021-01-...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2020-01-23 14:30:00+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021-0-146;Órgano de Contrataci...</td>
      <td>Suministro de tres Lámparas Quirúrgicas para e...</td>
      <td>2022-01-07 12:41:20.663000+00:00</td>
      <td>2021-0-146</td>
      <td>RES</td>
      <td>Hospital Universitario Doce de Octubre</td>
      <td>Consejería de Sanidad</td>
      <td>Servicio Madrileño de Salud</td>
      <td>Suministro de tres Lámparas Quirúrgicas para e...</td>
      <td>...</td>
      <td>[2021-08-09, 2021-09-20, 2021-09-28]</td>
      <td>http://www.madrid.org/cs/Satellite?cid=1204201...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8168_SVISPLN 8/2021; Órgano de ...</td>
      <td>Contrato de suministro de la vacuna frente al ...</td>
      <td>2022-01-07 12:30:11.660000+00:00</td>
      <td>8168_SVISPLN 8/2021</td>
      <td>RES</td>
      <td>Instituto de Salud Pública y Laboral de Navarra</td>
      <td>INSTITUTO DE SALUD PÚBLICA Y LABORAL DE NAVARRA</td>
      <td>&lt;NA&gt;</td>
      <td>Contrato de suministro de la vacuna frente al ...</td>
      <td>...</td>
      <td>2022-01-07</td>
      <td>&lt;NA&gt;</td>
      <td>2022-01-01</td>
      <td>2022-12-31</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 3068_KONTRATUAK/2021/12; Órgano...</td>
      <td>Contratación de las obras del lote 1 del proye...</td>
      <td>2022-01-07 12:30:10.891000+00:00</td>
      <td>3068_KONTRATUAK/2021/12</td>
      <td>ADJ</td>
      <td>Alkatea / Alcalde</td>
      <td>Berako Udala / Ayuntamiento de Bera</td>
      <td>&lt;NA&gt;</td>
      <td>Contratación de las obras del lote 1 del proye...</td>
      <td>...</td>
      <td>[2021-11-23, 2021-12-02, 2022-01-07]</td>
      <td>&lt;NA&gt;</td>
      <td>2022-01-10</td>
      <td>2022-08-15</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaT</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zips_df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>id                      string
summary                 string
title                   string
updated    datetime64[ns, UTC]
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unwanted index <em>levels</em> can be easily removed</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zips_df</span><span class="o">.</span><span class="n">droplevel</span><span class="p">([</span><span class="s1">'zip'</span><span class="p">,</span> <span class="s1">'file name'</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>...</th>
      <th>ContractFolderStatus - ValidNoticeInfo - AdditionalPublicationStatus - AdditionalPublicationDocumentReference - IssueDate</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
    <tr>
      <th>entry</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2019/51-HH-ZE; Órgano de Contr...</td>
      <td>Servicios de asistencia técnica para la dinami...</td>
      <td>2022-01-07 12:41:24.713000+00:00</td>
      <td>2019/51-HH-ZE</td>
      <td>RES</td>
      <td>Diputado/a Foral de Medio Ambiente y Obras Hid...</td>
      <td>Diputación Foral de Gipuzkoa</td>
      <td>Departamento de Medio Ambiente y Obras Hidrául...</td>
      <td>Servicios de asistencia técnica para la dinami...</td>
      <td>...</td>
      <td>[2019-12-23, 2020-01-02, 2020-05-07, [2021-01-...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2020-01-23 14:30:00+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2019/49-VA-ZE; Órgano de Contr...</td>
      <td>Servicios de asesoramiento en comunicación par...</td>
      <td>2022-01-07 12:41:24.627000+00:00</td>
      <td>2019/49-VA-ZE</td>
      <td>RES</td>
      <td>Diputado/a Foral de Medio Ambiente y Obras Hid...</td>
      <td>Diputación Foral de Gipuzkoa</td>
      <td>Departamento de Medio Ambiente y Obras Hidrául...</td>
      <td>Servicios de asesoramiento en comunicación par...</td>
      <td>...</td>
      <td>[2019-12-23, 2020-01-02, 2020-05-07, [2021-01-...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2020-01-23 14:30:00+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021-0-146;Órgano de Contrataci...</td>
      <td>Suministro de tres Lámparas Quirúrgicas para e...</td>
      <td>2022-01-07 12:41:20.663000+00:00</td>
      <td>2021-0-146</td>
      <td>RES</td>
      <td>Hospital Universitario Doce de Octubre</td>
      <td>Consejería de Sanidad</td>
      <td>Servicio Madrileño de Salud</td>
      <td>Suministro de tres Lámparas Quirúrgicas para e...</td>
      <td>...</td>
      <td>[2021-08-09, 2021-09-20, 2021-09-28]</td>
      <td>http://www.madrid.org/cs/Satellite?cid=1204201...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8168_SVISPLN 8/2021; Órgano de ...</td>
      <td>Contrato de suministro de la vacuna frente al ...</td>
      <td>2022-01-07 12:30:11.660000+00:00</td>
      <td>8168_SVISPLN 8/2021</td>
      <td>RES</td>
      <td>Instituto de Salud Pública y Laboral de Navarra</td>
      <td>INSTITUTO DE SALUD PÚBLICA Y LABORAL DE NAVARRA</td>
      <td>&lt;NA&gt;</td>
      <td>Contrato de suministro de la vacuna frente al ...</td>
      <td>...</td>
      <td>2022-01-07</td>
      <td>&lt;NA&gt;</td>
      <td>2022-01-01</td>
      <td>2022-12-31</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 3068_KONTRATUAK/2021/12; Órgano...</td>
      <td>Contratación de las obras del lote 1 del proye...</td>
      <td>2022-01-07 12:30:10.891000+00:00</td>
      <td>3068_KONTRATUAK/2021/12</td>
      <td>ADJ</td>
      <td>Alkatea / Alcalde</td>
      <td>Berako Udala / Ayuntamiento de Bera</td>
      <td>&lt;NA&gt;</td>
      <td>Contratación de las obras del lote 1 del proye...</td>
      <td>...</td>
      <td>[2021-11-23, 2021-12-02, 2022-01-07]</td>
      <td>&lt;NA&gt;</td>
      <td>2022-01-10</td>
      <td>2022-08-15</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaT</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># pd.reset_option('display.max_rows')</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extra-tests">Extra tests<a class="anchor-link" href="#Extra-tests"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">script</span> false --no-raise-error

# data_file = pathlib.Path.cwd() / 'data' / 'agregados'
# data_file /= 'PlataformasAgregadasSinMenores_202201.zip'
# data_file /= 'PlataformasAgregadasSinMenores_202202.zip'
# data_file /= 'PlataformasAgregadasSinMenores_202203.zip'


data_file = pathlib.Path.cwd() / 'data' / 'perfiles_plataforma'
data_file /= 'licitacionesPerfilesContratanteCompleto3_202201.zip'
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">script</span> false --no-raise-error

df = read_zip(data_file, concatenate=True)
df.shape
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">script</span> false --no-raise-error

df['ContractFolderStatus - ProcurementProject - BudgetAmount - TotalAmount'].dtype
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">script</span> false --no-raise-error

grouping_col = dlsproc.structure.assemble_name(['ContractFolderStatus', 'LocatedContractingParty', 'Party', 'PartyName', 'Name'])
grouping_col
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">script</span> false --no-raise-error

amount_col = dlsproc.structure.assemble_name(['ContractFolderStatus', 'ProcurementProject', 'BudgetAmount', 'TotalAmount'])
amount_col
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">script</span> false --no-raise-error

df.groupby(grouping_col).agg(money=(amount_col, 'sum'), n=(amount_col, 'size'))
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>


