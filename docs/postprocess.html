---

title: postprocess


keywords: fastai
sidebar: home_sidebar

summary: "Functionality to post-process already parsed data"
description: "Functionality to post-process already parsed data"
nb_path: "15_postprocess.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 15_postprocess.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to avoid circular dependencies in the resulting <em>Python</em> modules, and since this is only for testing</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dlsproc.xml</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sample-data">Sample data<a class="anchor-link" href="#Sample-data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Directory where the data (<em>XML</em> files) are stored</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">directory</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s1">&#39;samples&#39;</span>
<span class="k">assert</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="n">directory</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;/home/manu/dlsproc/samples&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A (sample) file in that directory</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xml_file</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="s1">&#39;PlataformasAgregadasSinMenores_20220104_030016_1.atom&#39;</span>
<span class="k">assert</span> <span class="n">xml_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="n">xml_file</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;/home/manu/dlsproc/samples/PlataformasAgregadasSinMenores_20220104_030016_1.atom&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">xml</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">xml_file</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>...</th>
      <th>ContractFolderStatus - LegalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - ID</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: C. 2-2021; Órgano de Contrataci...</td>
      <td>L'objecte del contracte és la renovació de tot...</td>
      <td>2022-01-03T01:11:41.826+01:00</td>
      <td>C. 2-2021</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Sant Ramon</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte del contracte és la renovació de tot...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8128_3/2021; Órgano de Contrata...</td>
      <td>Obras de restauración hidromorfológica del río...</td>
      <td>2022-01-03T01:00:11.194+01:00</td>
      <td>8128_3/2021</td>
      <td>PUB</td>
      <td>NaN</td>
      <td>Pleno del Ayuntamiento</td>
      <td>AYUNTAMIENTO DE MONREAL</td>
      <td>Obras de restauración hidromorfológica del río...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 1000_0005-CP01-2021-000063; Órg...</td>
      <td>Contrato del servicio de realización de labore...</td>
      <td>2022-01-03T01:00:10.399+01:00</td>
      <td>1000_0005-CP01-2021-000063</td>
      <td>EV</td>
      <td>NaN</td>
      <td>El Director General de Comunicación y Relacion...</td>
      <td>Departamento de Presidencia, Igualdad, Función...</td>
      <td>Contrato del servicio de realización de labore...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 1379/2020 4738; Órgano de Contr...</td>
      <td>Obres de renovació de l'enllumenat públic a la...</td>
      <td>2022-01-03T00:11:40.740+01:00</td>
      <td>1379/2020 4738</td>
      <td>EV</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Canet de Mar</td>
      <td>Entitats municipals de Catalunya</td>
      <td>Obres de renovació de l'enllumenat públic a la...</td>
      <td>...</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021-44; Órgano de Contratación...</td>
      <td>Subministre i la instal·lació fotovoltaica en ...</td>
      <td>2022-01-03T00:11:40.696+01:00</td>
      <td>2021-44</td>
      <td>EV</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Valls</td>
      <td>Entitats municipals de Catalunya</td>
      <td>Subministre i la instal·lació fotovoltaica en ...</td>
      <td>...</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Enllac plec clausules tecniques.doc</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>112</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 1005_391-2021; Órgano de Contra...</td>
      <td>Apoyo a la gestión del patrimonio filmográfico...</td>
      <td>2021-12-31T01:00:14.946+01:00</td>
      <td>1005_391-2021</td>
      <td>PUB</td>
      <td>NaN</td>
      <td>Dirección General de Cultura-Institución Prínc...</td>
      <td>Departamento de Cultura, Deporte y Juventud</td>
      <td>Apoyo a la gestión del patrimonio filmográfico...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8165_3/2021; Órgano de Contrata...</td>
      <td>Asistencia técnica para la prestación del serv...</td>
      <td>2021-12-31T01:00:14.393+01:00</td>
      <td>8165_3/2021</td>
      <td>EV</td>
      <td>NaN</td>
      <td>Mancomunidad de Servicios Sociales de Base de ...</td>
      <td>MANCOMUNIDAD DE SERVICIOS DE HUARTE Y DE ESTER...</td>
      <td>Asistencia técnica para la prestación del serv...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>114</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8113_3/2021; Órgano de Contrata...</td>
      <td>Contrato de servicios de desinfección, desinse...</td>
      <td>2021-12-31T01:00:13.594+01:00</td>
      <td>8113_3/2021</td>
      <td>EV</td>
      <td>NaN</td>
      <td>Subdirector de Gestión y Recursos</td>
      <td>Agencia Navarra para la Dependencia</td>
      <td>Contrato de servicios de desinfección, desinse...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2022-01-01</td>
      <td>2022-12-31</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>115</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8113_01 2021; Órgano de Contrat...</td>
      <td>Contrato del Servicio de Teleasistencia para l...</td>
      <td>2021-12-31T01:00:12.604+01:00</td>
      <td>8113_01 2021</td>
      <td>EV</td>
      <td>NaN</td>
      <td>Agencia Navarra de Autonomía y Desarrollo de l...</td>
      <td>Agencia Navarra para la Dependencia</td>
      <td>Contrato del Servicio de Teleasistencia para l...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>116</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 0001264/2021; Órgano de contrat...</td>
      <td>2021/pa-44-4 servicio de mantenimiento integra...</td>
      <td>2021-12-31T00:14:15.739+01:00</td>
      <td>0001264/2021</td>
      <td>RES</td>
      <td>NaN</td>
      <td>Agencia Pública Empresarial Sanitaria Bajo Gua...</td>
      <td>Junta de Andalucía</td>
      <td>2021/pa-44-4 servicio de mantenimiento integra...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>117 rows × 38 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are some <em>multivalued</em> columns</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dlsproc</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">multivalued_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;ContractFolderStatus - ProcurementProject - RequiredCommodityClassification - ItemClassificationCode&#39;,
 &#39;ContractFolderStatus - TenderResult - ResultCode&#39;,
 &#39;ContractFolderStatus - TenderResult - ReceivedTenderQuantity&#39;,
 &#39;ContractFolderStatus - TenderResult - WinningParty - PartyIdentification - ID&#39;,
 &#39;ContractFolderStatus - TenderResult - WinningParty - PartyName - Name&#39;,
 &#39;ContractFolderStatus - TenderResult - AwardedTenderedProject - LegalMonetaryTotal - TaxExclusiveAmount&#39;,
 &#39;ContractFolderStatus - ValidNoticeInfo - NoticeTypeCode&#39;,
 &#39;ContractFolderStatus - ValidNoticeInfo - AdditionalPublicationStatus - PublicationMediaName&#39;,
 &#39;ContractFolderStatus - ValidNoticeInfo - AdditionalPublicationStatus - AdditionalPublicationDocumentReference - IssueDate&#39;,
 &#39;ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Columns'-types">Columns' types<a class="anchor-link" href="#Columns'-types"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The list below specifies fields that are to be interpreted as <code>str</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">str_columns</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[&#39;ContractFolderStatus&#39;,
  &#39;LocatedContractingParty&#39;,
  &#39;Party&#39;,
  &#39;PostalAddress&#39;,
  &#39;PostalZone&#39;]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For easier processing, the <code>list</code>s are turned into <code>str</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">assembled_str_columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;ContractFolderStatus - LocatedContractingParty - Party - PostalAddress - PostalZone&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A function to tidy up some things in the <code>pd.DataFrame</code>s returned by <code>dlsproc.xml.to_df</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="typecast_columns" class="doc_header"><code>typecast_columns</code><a href="https://github.com/manuvazquez/dlsproc/tree/master/dlsproc/postprocess.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>typecast_columns</code>(<strong><code>input_df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>Tidy up the <code>pd.DataFrame</code> returned by <a href="/dlsproc/xml.html#to_df"><code>to_df</code></a>.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p>input_df: pd.DataFrame</p>
<p>Input DataFrame as ready by <a href="/dlsproc/xml.html#to_df"><code>to_df</code></a>.</p>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><p>out: pd.DataFrame</p>
<p>Post-processed DataFrame.</p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post_df</span> <span class="o">=</span> <span class="n">typecast_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">post_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>...</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - ID</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: C. 2-2021; Órgano de Contrataci...</td>
      <td>L'objecte del contracte és la renovació de tot...</td>
      <td>2022-01-03 00:11:41.826000+00:00</td>
      <td>C. 2-2021</td>
      <td>ADJ</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Sant Ramon</td>
      <td>Entitats municipals de Catalunya</td>
      <td>L'objecte del contracte és la renovació de tot...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>2021-12-17 14:00:00+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8128_3/2021; Órgano de Contrata...</td>
      <td>Obras de restauración hidromorfológica del río...</td>
      <td>2022-01-03 00:00:11.194000+00:00</td>
      <td>8128_3/2021</td>
      <td>PUB</td>
      <td>&lt;NA&gt;</td>
      <td>Pleno del Ayuntamiento</td>
      <td>AYUNTAMIENTO DE MONREAL</td>
      <td>Obras de restauración hidromorfológica del río...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>2022-01-22 23:30:00+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 1000_0005-CP01-2021-000063; Órg...</td>
      <td>Contrato del servicio de realización de labore...</td>
      <td>2022-01-03 00:00:10.399000+00:00</td>
      <td>1000_0005-CP01-2021-000063</td>
      <td>EV</td>
      <td>&lt;NA&gt;</td>
      <td>El Director General de Comunicación y Relacion...</td>
      <td>Departamento de Presidencia, Igualdad, Función...</td>
      <td>Contrato del servicio de realización de labore...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 1379/2020 4738; Órgano de Contr...</td>
      <td>Obres de renovació de l'enllumenat públic a la...</td>
      <td>2022-01-02 23:11:40.740000+00:00</td>
      <td>1379/2020 4738</td>
      <td>EV</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Canet de Mar</td>
      <td>Entitats municipals de Catalunya</td>
      <td>Obres de renovació de l'enllumenat públic a la...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>2022-01-02 23:59:00+00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 2021-44; Órgano de Contratación...</td>
      <td>Subministre i la instal·lació fotovoltaica en ...</td>
      <td>2022-01-02 23:11:40.696000+00:00</td>
      <td>2021-44</td>
      <td>EV</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>Ajuntament de Valls</td>
      <td>Entitats municipals de Catalunya</td>
      <td>Subministre i la instal·lació fotovoltaica en ...</td>
      <td>...</td>
      <td>Enllac plec clausules tecniques.doc</td>
      <td>https://contractaciopublica.gencat.cat/ecofin_...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>2022-01-02 23:59:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 39 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After post-processing some <code>object</code>s have been parsed as dates.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post_df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>id                                                      string
summary                                                 string
title                                                   string
updated                                    datetime64[ns, UTC]
ContractFolderStatus - ContractFolderID                 string
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Multivalued</em> columns are still <em>multivalued</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">multivalued_columns</span><span class="p">(</span><span class="n">post_df</span><span class="p">)</span> <span class="o">==</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">multivalued_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Most-recent-update">Most recent update<a class="anchor-link" href="#Most-recent-update"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>updated</em>, <strong>after post-processing</strong> is apt for ordering</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post_df</span><span class="p">[</span><span class="s1">&#39;updated&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>datetime64[ns, UTC]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We order the entries by <em>updated</em> date (ascending order) and then  group by <em>id</em></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">post_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;updated&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are interested in groups with more than one element</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">not_one_element_group</span> <span class="o">=</span> <span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">not_one_element_group</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>id
https://contrataciondelestado.es/sindicacion/P...    False
https://contrataciondelestado.es/sindicacion/P...    False
https://contrataciondelestado.es/sindicacion/P...    False
https://contrataciondelestado.es/sindicacion/P...    False
https://contrataciondelestado.es/sindicacion/P...    False
                                                     ...  
https://contrataciondelestado.es/sindicacion/P...    False
https://contrataciondelestado.es/sindicacion/P...    False
https://contrataciondelestado.es/sindicacion/P...    False
https://contrataciondelestado.es/sindicacion/P...    False
https://contrataciondelestado.es/sindicacion/P...    False
Length: 115, dtype: bool</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Number of tenders with updates</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">not_one_element_group</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">actual_groups</span> <span class="o">=</span> <span class="n">not_one_element_group</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">not_one_element_group</span><span class="p">]</span>
<span class="n">actual_groups</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/8904280&#39;, &#39;https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/8994209&#39;], dtype=&#39;string&#39;, name=&#39;id&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is a group with this number of elements</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For getting groups with <em>exactly</em> a certain number of elements (here $2$ again)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">size_2_groups</span> <span class="o">=</span> <span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">size_2_groups</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/8904280&#39;, &#39;https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/8994209&#39;], dtype=&#39;string&#39;, name=&#39;id&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_group</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">actual_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">first_group</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>...</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - ID</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 3069_1/2021; Órgano de Contrata...</td>
      <td>Construcción de depósito regulador de 100m3 en...</td>
      <td>2022-01-01 00:00:16.761000+00:00</td>
      <td>3069_1/2021</td>
      <td>EV</td>
      <td>&lt;NA&gt;</td>
      <td>CONCEJO DE GALBARRA</td>
      <td>Concejo de Galbarra</td>
      <td>Construcción de depósito regulador de 100m3 en...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>19</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 3069_1/2021; Órgano de Contrata...</td>
      <td>Construcción de depósito regulador de 100m3 en...</td>
      <td>2022-01-01 07:30:09.698000+00:00</td>
      <td>3069_1/2021</td>
      <td>EV</td>
      <td>&lt;NA&gt;</td>
      <td>CONCEJO DE GALBARRA</td>
      <td>Concejo de Galbarra</td>
      <td>Construcción de depósito regulador de 100m3 en...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 39 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>True</code> if columns are different across elements</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns_are_different</span> <span class="o">=</span> <span class="n">first_group</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">first_group</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">columns_are_different</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>id                                                                                                                           False
summary                                                                                                                      False
title                                                                                                                        False
updated                                                                                                                       True
ContractFolderStatus - ContractFolderID                                                                                      False
ContractFolderStatus - ContractFolderStatusCode                                                                              False
ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID                                                            True
ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name                                                    False
ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name                                       False
ContractFolderStatus - ProcurementProject - Name                                                                             False
ContractFolderStatus - ProcurementProject - TypeCode                                                                         False
ContractFolderStatus - ProcurementProject - BudgetAmount - EstimatedOverallContractAmount                                    False
ContractFolderStatus - ProcurementProject - BudgetAmount - TaxExclusiveAmount                                                False
ContractFolderStatus - ProcurementProject - RequiredCommodityClassification - ItemClassificationCode                         False
ContractFolderStatus - ProcurementProject - RealizedLocation - CountrySubentityCode                                          False
ContractFolderStatus - ProcurementProject - PlannedPeriod - DurationMeasure                                                  False
ContractFolderStatus - TenderResult - ResultCode                                                                              True
ContractFolderStatus - TenderResult - ReceivedTenderQuantity                                                                  True
ContractFolderStatus - TenderResult - WinningParty - PartyIdentification - ID                                                 True
ContractFolderStatus - TenderResult - WinningParty - PartyName - Name                                                         True
ContractFolderStatus - TenderResult - AwardedTenderedProject - LegalMonetaryTotal - TaxExclusiveAmount                        True
ContractFolderStatus - TenderingProcess - ProcedureCode                                                                      False
ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod - EndDate                                            True
ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod - EndTime                                            True
ContractFolderStatus - ValidNoticeInfo - NoticeTypeCode                                                                      False
ContractFolderStatus - ValidNoticeInfo - AdditionalPublicationStatus - PublicationMediaName                                  False
ContractFolderStatus - ValidNoticeInfo - AdditionalPublicationStatus - AdditionalPublicationDocumentReference - IssueDate     True
ContractFolderStatus - LegalDocumentReference - ID                                                                            True
ContractFolderStatus - LegalDocumentReference - Attachment - ExternalReference - URI                                          True
ContractFolderStatus - TechnicalDocumentReference - ID                                                                        True
ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI                                      True
ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate                                                         True
ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate                                                           True
ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID                                             True
ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name                   True
ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate                                       True
ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime                                       True
ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID                                        True
ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod                                                      True
dtype: bool</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The values in those columns are (besides <em>updated</em>) all <code>nan</code>s</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_group</span><span class="p">[</span><span class="n">first_group</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">columns_are_different</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>updated</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - TenderResult - ResultCode</th>
      <th>ContractFolderStatus - TenderResult - ReceivedTenderQuantity</th>
      <th>ContractFolderStatus - TenderResult - WinningParty - PartyIdentification - ID</th>
      <th>ContractFolderStatus - TenderResult - WinningParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - LegalMonetaryTotal - TaxExclusiveAmount</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod - EndTime</th>
      <th>ContractFolderStatus - ValidNoticeInfo - AdditionalPublicationStatus - AdditionalPublicationDocumentReference - IssueDate</th>
      <th>...</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - ID</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>2022-01-01 00:00:16.761000+00:00</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>[2021-12-16, 2021-12-16, 2021-12-16, 2021-12-1...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2022-01-01 07:30:09.698000+00:00</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>[2021-12-16, 2021-12-16, 2021-12-16, 2021-12-1...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 22 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Only the last element of each group (the most recent entry) is kept</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">only_last_update_df</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">last</span><span class="p">()</span>
<span class="n">only_last_update_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>ContractFolderStatus - ProcurementProject - TypeCode</th>
      <th>...</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - ID</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>https://contrataciondelestado.es/sindicacion/P...</th>
      <td>Id licitación: 6011900114;Órgano de Contrataci...</td>
      <td>Servicio de migración de los productos BMC ins...</td>
      <td>2021-12-31 10:56:15.855000+00:00</td>
      <td>6011900114</td>
      <td>RES</td>
      <td>http://www.madrid.org/cs/Satellite?cid=1204201...</td>
      <td>Empresa Pública de Metro de Madrid, S.A.</td>
      <td>Consejería de Transportes e Infraestructuras</td>
      <td>Servicio de migración de los productos BMC ins...</td>
      <td>2.0</td>
      <td>...</td>
      <td>1354764548025.pdf</td>
      <td>http://www.madrid.org/contratos-publicos/13547...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>None</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>https://contrataciondelestado.es/sindicacion/P...</th>
      <td>Id licitación: 11/2019; Órgano de Contratació...</td>
      <td>Concurso de proyectos para la rehabilitación u...</td>
      <td>2021-12-31 10:41:20.201000+00:00</td>
      <td>11/2019</td>
      <td>EV</td>
      <td>&lt;NA&gt;</td>
      <td>Alcaldia</td>
      <td>Ayuntamiento de Leioa</td>
      <td>Concurso de proyectos para la rehabilitación u...</td>
      <td>2.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>Ayuntamiento de Leioa</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>None</td>
      <td>2020-01-23 17:00:00+00:00</td>
    </tr>
    <tr>
      <th>https://contrataciondelestado.es/sindicacion/P...</th>
      <td>Id licitación: 6012000208;Órgano de Contrataci...</td>
      <td>Suministro de equipos de manutención (carretil...</td>
      <td>2021-12-31 11:11:15.851000+00:00</td>
      <td>6012000208</td>
      <td>RES</td>
      <td>http://www.madrid.org/cs/Satellite?cid=1204201...</td>
      <td>Empresa Pública de Metro de Madrid, S.A.</td>
      <td>Consejería de Transportes e Infraestructuras</td>
      <td>Suministro de equipos de manutención (carretil...</td>
      <td>1.0</td>
      <td>...</td>
      <td>1354836373815.pdf</td>
      <td>http://www.madrid.org/contratos-publicos/13548...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>None</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>https://contrataciondelestado.es/sindicacion/P...</th>
      <td>Id licitación: 6012100119;Órgano de Contrataci...</td>
      <td>Servicio de soporte al mantenimiento de instal...</td>
      <td>2021-12-31 10:11:16.027000+00:00</td>
      <td>6012100119</td>
      <td>RES</td>
      <td>http://www.madrid.org/cs/Satellite?cid=1204201...</td>
      <td>Empresa Pública de Metro de Madrid, S.A.</td>
      <td>Consejería de Transportes e Infraestructuras</td>
      <td>Servicio de soporte al mantenimiento de instal...</td>
      <td>2.0</td>
      <td>...</td>
      <td>1354874714036.pdf</td>
      <td>http://www.madrid.org/contratos-publicos/13548...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>None</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>https://contrataciondelestado.es/sindicacion/P...</th>
      <td>Id Licitación: PcPG/2021/801758, Órgano de Con...</td>
      <td>Servicio para la caracterización hidromorfolóx...</td>
      <td>2022-01-02 22:11:15.096000+00:00</td>
      <td>PcPG/2021/801758</td>
      <td>RES</td>
      <td>https://www.contratosdegalicia.gal//consultaOr...</td>
      <td>Ente Público Empresarial Augas de Galicia</td>
      <td>&lt;NA&gt;</td>
      <td>Servicio para la caracterización hidromorfolóx...</td>
      <td>2.0</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>A12024974</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>None</td>
      <td>2021-06-03 14:00:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 38 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A function which keeps, for every procurement entry, only the last update.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="keep_updates_only" class="doc_header"><code>keep_updates_only</code><a href="https://github.com/manuvazquez/dlsproc/tree/master/dlsproc/postprocess.py#L106" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>keep_updates_only</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">post_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>117</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">only_updated_df</span> <span class="o">=</span> <span class="n">keep_updates_only</span><span class="p">(</span><span class="n">post_df</span><span class="p">)</span>
<span class="n">only_updated_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>summary</th>
      <th>title</th>
      <th>updated</th>
      <th>ContractFolderStatus - ContractFolderID</th>
      <th>ContractFolderStatus - ContractFolderStatusCode</th>
      <th>ContractFolderStatus - LocatedContractingParty - BuyerProfileURIID</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyName - Name</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - ProcurementProject - Name</th>
      <th>...</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - ID</th>
      <th>ContractFolderStatus - TechnicalDocumentReference - Attachment - ExternalReference - URI</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - StartDate</th>
      <th>ContractFolderStatus - ProcurementProject - PlannedPeriod - EndDate</th>
      <th>ContractFolderStatus - LocatedContractingParty - Party - PartyIdentification - ID</th>
      <th>ContractFolderStatus - LocatedContractingParty - ParentLocatedParty - ParentLocatedParty - PartyName - Name</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndDate</th>
      <th>ContractFolderStatus - TenderingProcess - ParticipationRequestReceptionPeriod - EndTime</th>
      <th>ContractFolderStatus - TenderResult - AwardedTenderedProject - ProcurementProjectLotID</th>
      <th>ContractFolderStatus - TenderingProcess - TenderSubmissionDeadlinePeriod</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>116</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 0001264/2021; Órgano de contrat...</td>
      <td>2021/pa-44-4 servicio de mantenimiento integra...</td>
      <td>2021-12-30 23:14:15.739000+00:00</td>
      <td>0001264/2021</td>
      <td>RES</td>
      <td>&lt;NA&gt;</td>
      <td>Agencia Pública Empresarial Sanitaria Bajo Gua...</td>
      <td>Junta de Andalucía</td>
      <td>2021/pa-44-4 servicio de mantenimiento integra...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>2021-11-11 15:00:00+00:00</td>
    </tr>
    <tr>
      <th>115</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8113_01 2021; Órgano de Contrat...</td>
      <td>Contrato del Servicio de Teleasistencia para l...</td>
      <td>2021-12-31 00:00:12.604000+00:00</td>
      <td>8113_01 2021</td>
      <td>EV</td>
      <td>&lt;NA&gt;</td>
      <td>Agencia Navarra de Autonomía y Desarrollo de l...</td>
      <td>Agencia Navarra para la Dependencia</td>
      <td>Contrato del Servicio de Teleasistencia para l...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>114</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8113_3/2021; Órgano de Contrata...</td>
      <td>Contrato de servicios de desinfección, desinse...</td>
      <td>2021-12-31 00:00:13.594000+00:00</td>
      <td>8113_3/2021</td>
      <td>EV</td>
      <td>&lt;NA&gt;</td>
      <td>Subdirector de Gestión y Recursos</td>
      <td>Agencia Navarra para la Dependencia</td>
      <td>Contrato de servicios de desinfección, desinse...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>2022-01-01</td>
      <td>2022-12-31</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>113</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 8165_3/2021; Órgano de Contrata...</td>
      <td>Asistencia técnica para la prestación del serv...</td>
      <td>2021-12-31 00:00:14.393000+00:00</td>
      <td>8165_3/2021</td>
      <td>EV</td>
      <td>&lt;NA&gt;</td>
      <td>Mancomunidad de Servicios Sociales de Base de ...</td>
      <td>MANCOMUNIDAD DE SERVICIOS DE HUARTE Y DE ESTER...</td>
      <td>Asistencia técnica para la prestación del serv...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>112</th>
      <td>https://contrataciondelestado.es/sindicacion/P...</td>
      <td>Id licitación: 1005_391-2021; Órgano de Contra...</td>
      <td>Apoyo a la gestión del patrimonio filmográfico...</td>
      <td>2021-12-31 00:00:14.946000+00:00</td>
      <td>1005_391-2021</td>
      <td>PUB</td>
      <td>&lt;NA&gt;</td>
      <td>Dirección General de Cultura-Institución Prínc...</td>
      <td>Departamento de Cultura, Deporte y Juventud</td>
      <td>Apoyo a la gestión del patrimonio filmográfico...</td>
      <td>...</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>2022-01-14 23:59:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 39 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">only_updated_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>115</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deleted-series">Deleted series<a class="anchor-link" href="#Deleted-series"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dlsproc.bundle</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zip_file</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="s1">&#39;yearly&#39;</span> <span class="o">/</span> <span class="s1">&#39;PlataformasAgregadasSinMenores_2018.zip&#39;</span>
<span class="k">assert</span> <span class="n">zip_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="n">zip_file</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;/home/manu/dlsproc/samples/yearly/PlataformasAgregadasSinMenores_2018.zip&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deleted_series</span> <span class="o">=</span> <span class="n">dlsproc</span><span class="o">.</span><span class="n">bundle</span><span class="o">.</span><span class="n">read_deleted_zip</span><span class="p">(</span><span class="n">zip_file</span><span class="p">)</span>
<span class="n">deleted_series</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>file name                                              id                                                                                 
PlataformasAgregadasSinMenores_20180217_180137_1.atom  https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1985903   2018-01-04 13:11:18.021000+00:00
                                                       https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1969197   2018-01-04 13:11:17.921000+00:00
Name: deleted_on, dtype: datetime64[ns, UTC]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No duplicates</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deleted_series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We add an <em>artificial</em> one</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2017</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">deleted_series</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span>
<span class="n">deleted_series</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">deleted_series</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now have a duplicate</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deleted_series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A function to get rid of duplicates from a <em>deleted series</em>. The <strong>oldest</strong> entry is kept.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="deduplicate_deleted_series" class="doc_header"><code>deduplicate_deleted_series</code><a href="https://github.com/manuvazquez/dlsproc/tree/master/dlsproc/postprocess.py#L114" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>deduplicate_deleted_series</code>(<strong><code>series</code></strong>:<code>Series</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deduplicated_series</span> <span class="o">=</span> <span class="n">deduplicate_deleted_series</span><span class="p">(</span><span class="n">deleted_series</span><span class="p">)</span>
<span class="n">deduplicated_series</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>file name                                              id                                                                                 
PlataformasAgregadasSinMenores_20180217_190110_1.atom  https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/1996094   2018-02-07 09:01:16.378000+00:00
foo                                                    https://contrataciondelestado.es/sindicacion/PlataformasAgregadasSinMenores/2000163          2017-01-03 00:00:00+00:00
Name: deleted_on, dtype: datetime64[ns, UTC]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">deleted_series</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">deduplicated_series</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((52,), (51,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

